<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - ระบบจัดการโครงการที่พักอาศัย</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.css" rel="stylesheet">
    <style>
	@import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
	
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
			font-family: 'Sarabun', sans-serif;
            <!-- font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; -->
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            padding: 20px 0;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            position: fixed;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .sidebar.collapsed {
            transform: translateX(-100%);
        }

        .sidebar-header {
            padding: 0 20px 30px;
            border-bottom: 1px solid #34495e;
            margin-bottom: 20px;
        }

        .sidebar-header h2 {
            color: white;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            color: #bdc3c7;
            font-size: 14px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin: 5px 0;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #bdc3c7;
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background: linear-gradient(90deg, #3498db, #2980b9);
            color: white;
            transform: translateX(5px);
        }

        .sidebar-menu a i {
            width: 20px;
            margin-right: 10px;
        }

        .sidebar-menu a.loading {
            pointer-events: none;
            opacity: 0.7;
        }

        .sidebar-menu a.loading i {
            animation: spin 1s linear infinite;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            background: rgba(255,255,255,0.95);
            margin: 20px;
            margin-left: 280px;
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: margin-left 0.3s ease;
        }

        .main-content.expanded {
            margin-left: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #ecf0f1;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .menu-toggle {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .menu-toggle:hover {
            transform: scale(1.1);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 28px;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .notification-bell {
            position: relative;
            background: none;
            border: none;
            font-size: 20px;
            color: #666;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .notification-bell:hover {
            color: #3498db;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(45deg, #3498db, #9b59b6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .user-avatar:hover {
            transform: scale(1.1);
        }

        /* Summary Cards */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .summary-card:hover::before {
            transform: translateX(100%);
        }

        .summary-card.income {
            border-left-color: #27ae60;
        }

        .summary-card.pending {
            border-left-color: #f39c12;
        }

        .summary-card.approval {
            border-left-color: #e74c3c;
        }

        .summary-card.due-today {
            border-left-color: #9b59b6;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-title {
            color: #7f8c8d;
            font-size: 14px;
            font-weight: 500;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
            transition: transform 0.3s ease;
        }

        .summary-card:hover .card-icon {
            transform: rotate(10deg) scale(1.1);
        }

        .card-icon.income {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
        }

        .card-icon.pending {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }

        .card-icon.approval {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .card-icon.due-today {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
        }

        .card-value {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .card-change {
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .card-change.positive {
            color: #27ae60;
        }

        .card-change.negative {
            color: #e74c3c;
        }

        .card-change.neutral {
            color: #7f8c8d;
        }

        /* Content Sections */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .section:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .view-all-btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-all-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        /* Tables */
        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
            font-size: 13px;
        }

        .table td {
            font-size: 13px;
            color: #34495e;
        }

        .table tr:hover {
            background: rgba(52, 152, 219, 0.05);
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-paid {
            background: #d1ecf1;
            color: #0c5460;
        }

        .btn-action {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #27ae60, #229954);
            color: white;
        }

        .btn-action:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .quick-action-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        /* Charts Area */
        .charts-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 10% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: #666;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #e74c3c;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 20px;
            }
            
            .summary-cards {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 20px;
            }
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 3000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .toast.warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>Back Office</h2>
            <p>ระบบจัดการโครงการ</p>
        </div>
        <ul class="sidebar-menu">
            <li><a href="dashboard.html" class="active" data-page="dashboard" data-url="dashboard.html"><i class="fas fa-tachometer-alt"></i> แดชบอร์ด</a></li>
            <li><a href="payment-management.html" data-page="payment" data-url="payment-management.html"><i class="fas fa-credit-card"></i> จัดการการชำระเงิน</a></li>
            <li><a href="billing-management.html" data-page="billing" data-url="billing-management.html"><i class="fas fa-file-invoice"></i> จัดการบิล</a></li>
            <li><a href="resident-management.html" data-page="resident" data-url="resident-management.html"><i class="fas fa-users"></i> จัดการลูกบ้าน</a></li>
            <li><a href="notification.html" data-page="notification" data-url="notification.html"><i class="fas fa-bell"></i> การแจ้งเตือน</a></li>
            <li><a href="report.html" data-page="report" data-url="report.html"><i class="fas fa-chart-bar"></i> รายงาน</a></li>
            <li><a href="setting.html" data-page="setting" data-url="setting.html"><i class="fas fa-cog"></i> ตั้งค่า</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <header class="header">
            <div class="header-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1><i class="fas fa-tachometer-alt"></i> แดชบอร์ด</h1>
            </div>
            <div class="user-info">
                <button class="notification-bell" id="notificationBell">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationCount">3</span>
                </button>
                <span>สวัสดี, คุณสมชาย</span>
                <div class="user-avatar" id="userAvatar">SM</div>
            </div>
        </header>

        <!-- Summary Cards -->
        <section class="summary-cards">
            <div class="summary-card income" onclick="showCardDetail('income')">
                <div class="card-header">
                    <span class="card-title">ยอดรายรับเดือนนี้</span>
                    <div class="card-icon income">
                        <i class="fas fa-arrow-up"></i>
                    </div>
                </div>
                <div class="card-value" id="incomeValue">฿245,600</div>
                <div class="card-change positive">
                    <i class="fas fa-arrow-up"></i> +12.5% จากเดือนที่แล้ว
                </div>
            </div>

            <div class="summary-card pending" onclick="showCardDetail('pending')">
                <div class="card-header">
                    <span class="card-title">ยอดค้างชำระทั้งหมด</span>
                    <div class="card-icon pending">
                        <i class="fas fa-clock"></i>
                    </div>
                </div>
                <div class="card-value" id="pendingValue">฿89,400</div>
                <div class="card-change negative">
                    <i class="fas fa-arrow-down"></i> -5.2% จากเดือนที่แล้ว
                </div>
            </div>

            <div class="summary-card approval" onclick="showCardDetail('approval')">
                <div class="card-header">
                    <span class="card-title">สลิปรอการอนุมัติ</span>
                    <div class="card-icon approval">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                </div>
                <div class="card-value" id="approvalValue">12 รายการ</div>
                <div class="card-change neutral">
                    <i class="fas fa-clock"></i> ต้องดำเนินการด่วน
                </div>
            </div>

            <div class="summary-card due-today" onclick="showCardDetail('due-today')">
                <div class="card-header">
                    <span class="card-title">บิลที่ถึงกำหนดวันนี้</span>
                    <div class="card-icon due-today">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                </div>
                <div class="card-value" id="dueTodayValue">8 รายการ</div>
                <div class="card-change neutral">
                    <i class="fas fa-info-circle"></i> ต้องติดตาม
                </div>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="quick-actions">
            <button class="quick-action-btn" onclick="quickAction('create-bill')">
                <i class="fas fa-plus"></i> สร้างบิลใหม่
            </button>
            <button class="quick-action-btn" onclick="quickAction('approve-slip')">
                <i class="fas fa-check-circle"></i> อนุมัติสลิป
            </button>
            <button class="quick-action-btn" onclick="quickAction('send-notification')">
                <i class="fas fa-bullhorn"></i> ส่งการแจ้งเตือน
            </button>
            <button class="quick-action-btn" onclick="quickAction('export-report')">
                <i class="fas fa-file-export"></i> ส่งออกรายงาน
            </button>
        </section>

        <!-- Content Grid -->
        <div class="content-grid">
            <!-- Pending Approvals -->
            <section class="section">
                <div class="section-header">
                    <h3 class="section-title">สลิปรออนุมัติล่าสุด</h3>
                    <button class="view-all-btn" onclick="viewAll('pending-approvals')">ดูทั้งหมด</button>
                </div>
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ห้อง</th>
                                <th>ชื่อ</th>
                                <th>จำนวน</th>
                                <th>เวลา</th>
                                <th>การดำเนินการ</th>
                            </tr>
                        </thead>
                        <tbody id="pendingApprovalsTable">
                            <tr>
                                <td>A101</td>
                                <td>คุณสมใจ</td>
                                <td>฿1,500</td>
                                <td>10:30</td>
                                <td>
                                    <button class="btn-action btn-primary" onclick="checkSlip('A101')">ตรวจสอบ</button>
                                </td>
                            </tr>
                            <tr>
                                <td>B205</td>
                                <td>คุณมาลี</td>
                                <td>฿2,200</td>
                                <td>09:15</td>
                                <td>
                                    <button class="btn-action btn-primary" onclick="checkSlip('B205')">ตรวจสอบ</button>
                                </td>
                            </tr>
                            <tr>
                                <td>C308</td>
                                <td>คุณวิชัย</td>
                                <td>฿1,800</td>
                                <td>08:45</td>
                                <td>
                                    <button class="btn-action btn-primary" onclick="checkSlip('C308')">ตรวจสอบ</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Recent Payments -->
            <section class="section">
                <div class="section-header">
                    <h3 class="section-title">การชำระเงินล่าสุด</h3>
                    <button class="view-all-btn" onclick="viewAll('recent-payments')">ดูทั้งหมด</button>
                </div>
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ห้อง</th>
                                <th>ชื่อ</th>
                                <th>จำนวน</th>
                                <th>สถานะ</th>
                                <th>เวลา</th>
                            </tr>
                        </thead>
                        <tbody id="recentPaymentsTable">
                            <tr>
                                <td>A102</td>
                                <td>คุณปรีชา</td>
                                <td>฿1,500</td>
                                <td><span class="status-badge status-approved">อนุมัติแล้ว</span></td>
                                <td>11:20</td>
                            </tr>
                            <tr>
                                <td>B204</td>
                                <td>คุณสุดา</td>
                                <td>฿2,000</td>
                                <td><span class="status-badge status-paid">ชำระแล้ว</span></td>
                                <td>10:55</td>
                            </tr>
                            <tr>
                                <td>C301</td>
                                <td>คุณนิรันดร์</td>
                                <td>฿1,750</td>
                                <td><span class="status-badge status-approved">อนุมัติแล้ว</span></td>
                                <td>09:30</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- Charts Section -->
        <section class="charts-section">
            <h3 class="section-title">ภาพรวมรายรับ - รายจ่าย</h3>
            <div class="charts-grid">
                <div class="chart-container">
                    <canvas id="incomeChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="statusChart"></canvas>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">รายละเอียด</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody">
                <!-- Modal content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <span id="toastMessage"></span>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        // Global State
        let isLoading = false;
        let currentData = {
            income: 245600,
            pending: 89400,
            approval: 12,
            dueToday: 8
        };

        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            initializeCharts();
            startRealTimeUpdates();
            animateCards();
        });

        // Event Listeners
        function initializeEventListeners() {
            // Menu toggle
            document.getElementById('menuToggle').addEventListener('click', toggleSidebar);

            // Sidebar navigation
            document.querySelectorAll('.sidebar-menu a').forEach(link => {
                link.addEventListener('click', function(e) {
                    const url = this.dataset.url;
                    const page = this.dataset.page;
                    
                    // If we're already on the current page, prevent navigation
                    if (this.classList.contains('active')) {
                        e.preventDefault();
                        return;
                    }
                    
                    // Show loading state
                    showToast(`กำลังโหลด${getPageName(page)}...`, 'info');
                    
                    // Add loading effect to the clicked link
                    const originalText = this.innerHTML;
                    this.innerHTML = `<i class="fas fa-spinner fa-spin"></i> กำลังโหลด...`;
                    
                    // Simulate loading time then navigate
                    setTimeout(() => {
                        // Check if the file exists (in real implementation, you might want to do this check)
                        if (url && url !== 'dashboard.html') {
                            // Try to navigate to the URL
                            try {
                                window.location.href = url;
                            } catch (error) {
                                // If navigation fails, show error and restore
                                showToast(`ไม่พบหน้า ${getPageName(page)} กำลังสร้างหน้าใหม่...`, 'warning');
                                this.innerHTML = originalText;
                                
                                // Create the page or show placeholder
                                setTimeout(() => {
                                    createPlaceholderPage(page, url);
                                }, 1000);
                            }
                        } else {
                            // We're on dashboard, just update active state
                            this.innerHTML = originalText;
                            updateActiveState(this);
                        }
                    }, 800);
                });
            });

            // Close modal on outside click
            document.getElementById('modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });

            // Notification bell
            document.getElementById('notificationBell').addEventListener('click', showNotifications);

            // User avatar
            document.getElementById('userAvatar').addEventListener('click', showUserMenu);
        }

        // Toggle Sidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            sidebar.classList.toggle('collapsed');
            mainContent.classList.toggle('expanded');
        }

        // Update active state
        function updateActiveState(activeLink) {
            document.querySelectorAll('.sidebar-menu a').forEach(l => l.classList.remove('active'));
            activeLink.classList.add('active');
        }

        // Create placeholder page if file doesn't exist
        function createPlaceholderPage(page, url) {
            const pageTemplates = {
                'payment': {
                    title: 'จัดการการชำระเงิน',
                    content: generatePaymentManagementPage()
                },
                'billing': {
                    title: 'จัดการบิล',
                    content: generateBillingManagementPage()
                },
                'resident': {
                    title: 'จัดการลูกบ้าน',
                    content: generateResidentManagementPage()
                },
                'notification': {
                    title: 'การแจ้งเตือน',
                    content: generateNotificationPage()
                },
                'report': {
                    title: 'รายงาน',
                    content: generateReportPage()
                },
                'setting': {
                    title: 'ตั้งค่า',
                    content: generateSettingPage()
                }
            };

            const template = pageTemplates[page];
            if (template) {
                // Create new window/tab with the page content
                const newWindow = window.open('', '_blank');
                newWindow.document.write(template.content);
                newWindow.document.close();
                
                showToast(`เปิด${template.title}ในแท็บใหม่`, 'success');
            }
        }

        // Generate page templates
        function generatePaymentManagementPage() {
            return `
                <!DOCTYPE html>
                <html lang="th">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>จัดการการชำระเงิน - ระบบจัดการโครงการที่พักอาศัย</title>
                    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
                        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
                        .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #ecf0f1; }
                        .header h1 { color: #2c3e50; font-size: 28px; margin-bottom: 10px; }
                        .coming-soon { text-align: center; padding: 60px 20px; color: #7f8c8d; }
                        .coming-soon i { font-size: 64px; margin-bottom: 20px; color: #3498db; }
                        .back-btn { background: linear-gradient(45deg, #3498db, #2980b9); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px; }
                        .back-btn:hover { transform: translateY(-2px); }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1><i class="fas fa-credit-card"></i> จัดการการชำระเงิน</h1>
                            <p>ระบบจัดการการชำระเงินค่าส่วนกลางและค่าบริการต่าง ๆ</p>
                        </div>
                        <div class="coming-soon">
                            <i class="fas fa-tools"></i>
                            <h2>หน้านี้กำลังพัฒนา</h2>
                            <p>ระบบจัดการการชำระเงินจะเปิดให้บริการเร็ว ๆ นี้</p>
                            <button class="back-btn" onclick="window.close()">
                                <i class="fas fa-arrow-left"></i> กลับหน้าหลัก
                            </button>
                        </div>
                    </div>
                </body>
                </html>
            `;
        }

        function generateBillingManagementPage() {
            return `
                <!DOCTYPE html>
                <html lang="th">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>จัดการบิล - ระบบจัดการโครงการที่พักอาศัย</title>
                    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
                        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
                        .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #ecf0f1; }
                        .header h1 { color: #2c3e50; font-size: 28px; margin-bottom: 10px; }
                        .coming-soon { text-align: center; padding: 60px 20px; color: #7f8c8d; }
                        .coming-soon i { font-size: 64px; margin-bottom: 20px; color: #e67e22; }
                        .back-btn { background: linear-gradient(45deg, #e67e22, #d35400); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px; }
                        .back-btn:hover { transform: translateY(-2px); }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1><i class="fas fa-file-invoice"></i> จัดการบิล</h1>
                            <p>ระบบจัดการบิลค่าส่วนกลาง ค่าน้ำ ค่าไฟ และค่าบริการอื่น ๆ</p>
                        </div>
                        <div class="coming-soon">
                            <i class="fas fa-file-invoice"></i>
                            <h2>หน้านี้กำลังพัฒนา</h2>
                            <p>ระบบจัดการบิลจะเปิดให้บริการเร็ว ๆ นี้</p>
                            <button class="back-btn" onclick="window.close()">
                                <i class="fas fa-arrow-left"></i> กลับหน้าหลัก
                            </button>
                        </div>
                    </div>
                </body>
                </html>
            `;
        }

        function generateResidentManagementPage() {
            return `
                <!DOCTYPE html>
                <html lang="th">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>จัดการลูกบ้าน - ระบบจัดการโครงการที่พักอาศัย</title>
                    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
                        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
                        .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #ecf0f1; }
                        .header h1 { color: #2c3e50; font-size: 28px; margin-bottom: 10px; }
                        .coming-soon { text-align: center; padding: 60px 20px; color: #7f8c8d; }
                        .coming-soon i { font-size: 64px; margin-bottom: 20px; color: #27ae60; }
                        .back-btn { background: linear-gradient(45deg, #27ae60, #229954); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px; }
                        .back-btn:hover { transform: translateY(-2px); }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1><i class="fas fa-users"></i> จัดการลูกบ้าน</h1>
                            <p>ระบบจัดการข้อมูลลูกบ้าน การอนุมัติบัญชี และการจัดการสิทธิ์</p>
                        </div>
                        <div class="coming-soon">
                            <i class="fas fa-users"></i>
                            <h2>หน้านี้กำลังพัฒนา</h2>
                            <p>ระบบจัดการลูกบ้านจะเปิดให้บริการเร็ว ๆ นี้</p>
                            <button class="back-btn" onclick="window.close()">
                                <i class="fas fa-arrow-left"></i> กลับหน้าหลัก
                            </button>
                        </div>
                    </div>
                </body>
                </html>
            `;
        }

        function generateNotificationPage() {
            return `
                <!DOCTYPE html>
                <html lang="th">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>การแจ้งเตือน - ระบบจัดการโครงการที่พักอาศัย</title>
                    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
                        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
                        .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #ecf0f1; }
                        .header h1 { color: #2c3e50; font-size: 28px; margin-bottom: 10px; }
                        .coming-soon { text-align: center; padding: 60px 20px; color: #7f8c8d; }
                        .coming-soon i { font-size: 64px; margin-bottom: 20px; color: #f39c12; }
                        .back-btn { background: linear-gradient(45deg, #f39c12, #e67e22); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px; }
                        .back-btn:hover { transform: translateY(-2px); }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1><i class="fas fa-bell"></i> การแจ้งเตือน</h1>
                            <p>ระบบจัดการการแจ้งเตือนและการสื่อสารกับลูกบ้าน</p>
                        </div>
                        <div class="coming-soon">
                            <i class="fas fa-bell"></i>
                            <h2>หน้านี้กำลังพัฒนา</h2>
                            <p>ระบบการแจ้งเตือนจะเปิดให้บริการเร็ว ๆ นี้</p>
                            <button class="back-btn" onclick="window.close()">
                                <i class="fas fa-arrow-left"></i> กลับหน้าหลัก
                            </button>
                        </div>
                    </div>
                </body>
                </html>
            `;
        }

        function generateReportPage() {
            return `
                <!DOCTYPE html>
                <html lang="th">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>รายงาน - ระบบจัดการโครงการที่พักอาศัย</title>
                    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
                        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
                        .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #ecf0f1; }
                        .header h1 { color: #2c3e50; font-size: 28px; margin-bottom: 10px; }
                        .coming-soon { text-align: center; padding: 60px 20px; color: #7f8c8d; }
                        .coming-soon i { font-size: 64px; margin-bottom: 20px; color: #9b59b6; }
                        .back-btn { background: linear-gradient(45deg, #9b59b6, #8e44ad); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px; }
                        .back-btn:hover { transform: translateY(-2px); }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1><i class="fas fa-chart-bar"></i> รายงาน</h1>
                            <p>ระบบรายงานและสถิติการดำเนินงานของโครงการ</p>
                        </div>
                        <div class="coming-soon">
                            <i class="fas fa-chart-bar"></i>
                            <h2>หน้านี้กำลังพัฒนา</h2>
                            <p>ระบบรายงานจะเปิดให้บริการเร็ว ๆ นี้</p>
                            <button class="back-btn" onclick="window.close()">
                                <i class="fas fa-arrow-left"></i> กลับหน้าหลัก
                            </button>
                        </div>
                    </div>
                </body>
                </html>
            `;
        }

        function generateSettingPage() {
            return `
                <!DOCTYPE html>
                <html lang="th">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>ตั้งค่า - ระบบจัดการโครงการที่พักอาศัย</title>
                    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
                        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
                        .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #ecf0f1; }
                        .header h1 { color: #2c3e50; font-size: 28px; margin-bottom: 10px; }
                        .coming-soon { text-align: center; padding: 60px 20px; color: #7f8c8d; }
                        .coming-soon i { font-size: 64px; margin-bottom: 20px; color: #34495e; }
                        .back-btn { background: linear-gradient(45deg, #34495e, #2c3e50); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px; }
                        .back-btn:hover { transform: translateY(-2px); }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1><i class="fas fa-cog"></i> ตั้งค่า</h1>
                            <p>ตั้งค่าระบบและการจัดการผู้ใช้งาน</p>
                        </div>
                        <div class="coming-soon">
                            <i class="fas fa-cog"></i>
                            <h2>หน้านี้กำลังพัฒนา</h2>
                            <p>ระบบตั้งค่าจะเปิดให้บริการเร็ว ๆ นี้</p>
                            <button class="back-btn" onclick="window.close()">
                                <i class="fas fa-arrow-left"></i> กลับหน้าหลัก
                            </button>
                        </div>
                    </div>
                </body>
                </html>
            `;
        }

        function getPageName(page) {
            const pageNames = {
                'dashboard': 'แดชบอร์ด',
                'payment': 'จัดการการชำระเงิน',
                'billing': 'จัดการบิล',
                'resident': 'จัดการลูกบ้าน',
                'notification': 'การแจ้งเตือน',
                'report': 'รายงาน',
                'setting': 'ตั้งค่า'
            };
            return pageNames[page] || 'ไม่ทราบ';
        }

        // Quick Actions
        function quickAction(action) {
            const actions = {
                'create-bill': 'สร้างบิลใหม่',
                'approve-slip': 'อนุมัติสลิป',
                'send-notification': 'ส่งการแจ้งเตือน',
                'export-report': 'ส่งออกรายงาน'
            };

            showToast(`กำลัง${actions[action]}...`, 'info');
            
            // Simulate action
            setTimeout(() => {
                showToast(`${actions[action]}สำเร็จ`, 'success');
                
                // Update data if needed
                if (action === 'approve-slip') {
                    currentData.approval = Math.max(0, currentData.approval - 1);
                    updateSummaryCard('approval', currentData.approval + ' รายการ');
                }
            }, 1500);
        }

        // Card Details
        function showCardDetail(cardType) {
            const cardDetails = {
                'income': {
                    title: 'รายละเอียดรายรับเดือนนี้',
                    content: `
                        <div style="line-height: 1.6;">
                            <p><strong>ยอดรวมรายรับ:</strong> ฿245,600</p>
                            <p><strong>ค่าส่วนกลาง:</strong> ฿180,000 (73%)</p>
                            <p><strong>ค่าส่วนเสริม:</strong> ฿45,600 (19%)</p>
                            <p><strong>อื่นๆ:</strong> ฿20,000 (8%)</p>
                            <hr style="margin: 15px 0;">
                            <p><strong>เปรียบเทียบเดือนที่แล้ว:</strong> <span style="color: #27ae60;">+12.5% (฿27,300)</span></p>
                            <p><strong>เป้าหมายรายเดือน:</strong> ฿250,000</p>
                            <p><strong>ความสำเร็จ:</strong> <span style="color: #f39c12;">98.2%</span></p>
                        </div>
                    `
                },
                'pending': {
                    title: 'รายละเอียดค้างชำระ',
                    content: `
                        <div style="line-height: 1.6;">
                            <p><strong>ยอดรวมค้างชำระ:</strong> ฿89,400</p>
                            <p><strong>ค้าง 1-30 วัน:</strong> ฿45,000 (20 ราย)</p>
                            <p><strong>ค้าง 31-60 วัน:</strong> ฿32,400 (12 ราย)</p>
                            <p><strong>ค้างเกิน 60 วัน:</strong> ฿12,000 (5 ราย)</p>
                            <hr style="margin: 15px 0;">
                            <p><strong>การติดตาม:</strong></p>
                            <p>• ส่งจดหมายแจ้งเตือนแล้ว: 25 ราย</p>
                            <p>• รอการติดต่อกลับ: 12 ราย</p>
                        </div>
                    `
                },
                'approval': {
                    title: 'สลิปรอการอนุมัติ',
                    content: `
                        <div style="line-height: 1.6;">
                            <p><strong>รออนุมัติทั้งหมด:</strong> ${currentData.approval} รายการ</p>
                            <p><strong>ส่งเข้ามาวันนี้:</strong> 5 รายการ</p>
                            <p><strong>รอมากกว่า 24 ชม.:</strong> 3 รายการ</p>
                            <p><strong>จำนวนเฉลี่ยต่อวัน:</strong> 8 รายการ</p>
                            <hr style="margin: 15px 0;">
                            <p><strong>สถิติการอนุมัติ:</strong></p>
                            <p>• อนุมัติ: 85%</p>
                            <p>• ปฏิเสธ: 10%</p>
                            <p>• ขอข้อมูลเพิ่ม: 5%</p>
                        </div>
                    `
                },
                'due-today': {
                    title: 'บิลที่ถึงกำหนดวันนี้',
                    content: `
                        <div style="line-height: 1.6;">
                            <p><strong>บิลครบกำหนดวันนี้:</strong> ${currentData.dueToday} รายการ</p>
                            <p><strong>จำนวนเงินรวม:</strong> ฿18,500</p>
                            <p><strong>ติดต่อแล้ว:</strong> 5 ราย</p>
                            <p><strong>รอการติดต่อ:</strong> 3 ราย</p>
                            <hr style="margin: 15px 0;">
                            <p><strong>แผนการติดตาม:</strong></p>
                            <p>• โทรติดต่อ: 09:00-12:00</p>
                            <p>• ส่ง SMS แจ้งเตือน: 14:00</p>
                            <p>• อีเมลแจ้งเตือน: 16:00</p>
                        </div>
                    `
                }
            };

            const detail = cardDetails[cardType];
            if (detail) {
                showModal(detail.title, detail.content);
            }
        }

        // View All Functions
        function viewAll(section) {
            const sections = {
                'pending-approvals': 'สลิปรออนุมัติทั้งหมด',
                'recent-payments': 'การชำระเงินทั้งหมด'
            };

            showToast(`กำลังเปิด${sections[section]}...`, 'info');
            setTimeout(() => {
                showToast(`เปิด${sections[section]}สำเร็จ`, 'success');
            }, 1000);
        }

        // Check Slip Function
        function checkSlip(room) {
            showToast(`กำลังตรวจสอบสลิปห้อง ${room}...`, 'info');
            
            setTimeout(() => {
                const slipDetails = {
                    title: `ตรวจสอบสลิป - ห้อง ${room}`,
                    content: `
                        <div style="line-height: 1.6;">
                            <p><strong>ห้อง:</strong> ${room}</p>
                            <p><strong>ชื่อผู้ชำระ:</strong> ${getResidentName(room)}</p>
                            <p><strong>จำนวนเงิน:</strong> ${getSlipAmount(room)}</p>
                            <p><strong>วันที่ชำระ:</strong> ${getCurrentDate()}</p>
                            <p><strong>ธนาคาร:</strong> ไทยพาณิชย์</p>
                            <hr style="margin: 15px 0;">
                            <div style="display: flex; gap: 10px; margin-top: 20px;">
                                <button onclick="approveSlip('${room}')" style="background: #27ae60; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">อนุมัติ</button>
                                <button onclick="rejectSlip('${room}')" style="background: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">ปฏิเสธ</button>
                                <button onclick="requestMoreInfo('${room}')" style="background: #f39c12; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">ขอข้อมูลเพิ่ม</button>
                            </div>
                        </div>
                    `
                };
                
                showModal(slipDetails.title, slipDetails.content);
            }, 1000);
        }

        // Slip Actions
        function approveSlip(room) {
            showToast(`อนุมัติสลิปห้อง ${room} สำเร็จ`, 'success');
            closeModal();
            currentData.approval--;
            updateSummaryCard('approval', currentData.approval + ' รายการ');
            removeSlipFromTable(room);
        }

        function rejectSlip(room) {
            showToast(`ปฏิเสธสลิปห้อง ${room}`, 'error');
            closeModal();
            currentData.approval--;
            updateSummaryCard('approval', currentData.approval + ' รายการ');
            removeSlipFromTable(room);
        }

        function requestMoreInfo(room) {
            showToast(`ขอข้อมูลเพิ่มเติมจากห้อง ${room}`, 'warning');
            closeModal();
        }

        // Helper Functions
        function getResidentName(room) {
            const names = {
                'A101': 'คุณสมใจ',
                'B205': 'คุณมาลี',
                'C308': 'คุณวิชัย'
            };
            return names[room] || 'ไม่ทราบชื่อ';
        }

        function getSlipAmount(room) {
            const amounts = {
                'A101': '฿1,500',
                'B205': '฿2,200',
                'C308': '฿1,800'
            };
            return amounts[room] || '฿0';
        }

        function getCurrentDate() {
            return new Date().toLocaleDateString('th-TH');
        }

        function removeSlipFromTable(room) {
            const table = document.getElementById('pendingApprovalsTable');
            const rows = table.getElementsByTagName('tr');
            
            for (let i = 0; i < rows.length; i++) {
                if (rows[i].cells[0] && rows[i].cells[0].textContent === room) {
                    rows[i].remove();
                    break;
                }
            }
        }

        // Update Summary Card
        function updateSummaryCard(cardType, newValue) {
            const valueElement = document.getElementById(cardType + 'Value');
            if (valueElement) {
                valueElement.textContent = newValue;
                
                // Add flash effect
                valueElement.style.background = '#fff3cd';
                setTimeout(() => {
                    valueElement.style.background = 'transparent';
                }, 1000);
            }
        }

        // Notifications
        function showNotifications() {
            const notifications = [
                'มีสลิปใหม่รอการอนุมัติ - ห้อง D405',
                'การชำระเงินห้อง B203 สำเร็จแล้ว',
                'ระบบจะปิดปรับปรุงคืนนี้ 02:00-04:00'
            ];

            const content = notifications.map((notif, index) => 
                `<div style="padding: 10px; border-bottom: 1px solid #eee; ${index === notifications.length - 1 ? 'border-bottom: none;' : ''}">
                    <i class="fas fa-bell" style="color: #3498db; margin-right: 10px;"></i>
                    ${notif}
                </div>`
            ).join('');

            showModal('การแจ้งเตือน', content);
        }

        function showUserMenu() {
            const content = `
                <div style="line-height: 1.8;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(45deg, #3498db, #9b59b6); border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: bold;">SM</div>
                        <h3>คุณสมชาย มานะดี</h3>
                        <p style="color: #666;">ผู้ดูแลระบบ</p>
                    </div>
                    <hr style="margin: 20px 0;">
                    <div>
                        <button onclick="editProfile()" style="display: block; width: 100%; padding: 12px; margin-bottom: 10px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">แก้ไขโปรไฟล์</button>
                        <button onclick="changePassword()" style="display: block; width: 100%; padding: 12px; margin-bottom: 10px; background: #f39c12; color: white; border: none; border-radius: 5px; cursor: pointer;">เปลี่ยนรหัสผ่าน</button>
                        <button onclick="logout()" style="display: block; width: 100%; padding: 12px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer;">ออกจากระบบ</button>
                    </div>
                </div>
            `;

            showModal('โปรไฟล์ผู้ใช้', content);
        }

        function editProfile() {
            closeModal();
            showToast('กำลังเปิดหน้าแก้ไขโปรไฟล์...', 'info');
        }

        function changePassword() {
            closeModal();
            showToast('กำลังเปิดหน้าเปลี่ยนรหัสผ่าน...', 'info');
        }

        function logout() {
            closeModal();
            showToast('กำลังออกจากระบบ...', 'info');
            setTimeout(() => {
                showToast('ออกจากระบบสำเร็จ', 'success');
            }, 1500);
        }

        // Modal Functions
        function showModal(title, content) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').innerHTML = content;
            document.getElementById('modal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        // Toast Functions
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Charts
        function initializeCharts() {
            // Income Chart
            const incomeCtx = document.getElementById('incomeChart').getContext('2d');
            new Chart(incomeCtx, {
                type: 'bar',
                data: {
                    labels: ['ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.'],
                    datasets: [{
                        label: 'รายรับ',
                        data: [220000, 235000, 245000, 230000, 250000, 245600],
                        backgroundColor: 'rgba(52, 152, 219, 0.8)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    }, {
                        label: 'รายจ่าย',
                        data: [180000, 190000, 185000, 195000, 200000, 190000],
                        backgroundColor: 'rgba(231, 76, 60, 0.8)',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'รายรับ - รายจ่าย 6 เดือนย้อนหลัง'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '฿' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });

            // Status Chart
            const statusCtx = document.getElementById('statusChart').getContext('2d');
            new Chart(statusCtx, {
                type: 'doughnut',
                data: {
                    labels: ['ชำระแล้ว', 'ค้างชำระ', 'เกินกำหนด'],
                    datasets: [{
                        data: [65, 25, 10],
                        backgroundColor: [
                            'rgba(39, 174, 96, 0.8)',
                            'rgba(243, 156, 18, 0.8)',
                            'rgba(231, 76, 60, 0.8)'
                        ],
                        borderColor: [
                            'rgba(39, 174, 96, 1)',
                            'rgba(243, 156, 18, 1)',
                            'rgba(231, 76, 60, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'สถานะบิล (%)'
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Real-time Updates
        function startRealTimeUpdates() {
            setInterval(() => {
                if (Math.random() > 0.8) {
                    const changes = [
                        () => {
                            currentData.approval = Math.max(0, currentData.approval + (Math.random() > 0.5 ? 1 : -1));
                            updateSummaryCard('approval', currentData.approval + ' รายการ');
                            updateNotificationCount();
                        },
                        () => {
                            currentData.dueToday = Math.max(0, currentData.dueToday + (Math.random() > 0.6 ? 1 : -1));
                            updateSummaryCard('due-today', currentData.dueToday + ' รายการ');
                        }
                    ];
                    
                    const randomChange = changes[Math.floor(Math.random() * changes.length)];
                    randomChange();
                }
            }, 10000); // Update every 10 seconds
        }

        function updateNotificationCount() {
            const count = document.getElementById('notificationCount');
            const currentCount = parseInt(count.textContent);
            if (Math.random() > 0.7) {
                count.textContent = Math.max(0, currentCount + (Math.random() > 0.5 ? 1 : -1));
            }
        }

        // Animation
        function animateCards() {
            const cards = document.querySelectorAll('.summary-card, .section');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        // Responsive handling
        window.addEventListener('resize', function() {
            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.add('collapsed');
                document.getElementById('mainContent').classList.add('expanded');
            } else {
                document.getElementById('sidebar').classList.remove('collapsed');
                document.getElementById('mainContent').classList.remove('expanded');
            }
        });
    </script>
</body>
</html>